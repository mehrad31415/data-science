"0","library(ISLR)"
"0","library(caret)"
"0","library(leaps)"
"0","library(tidyverse)"
"0","library(gam)"
"0",""
"0","set.seed(0)"
"0","data(College)"
"0","dt <- createDataPartition(College$Outstate, p = 0.6, list = FALSE)"
"0","Train <- College[dt, ]"
"0","Test <- College[-dt, ]"
"0",""
"0","matrix <- model.matrix(Outstate ~ ., data = Train)"
"0",""
"0","fit <- regsubsets(x = matrix, y = Train$Outstate,method = 'forward', nvmax = 17)"
"2","Warning: 1  linear dependencies found"
"1","Reordering variables and trying again:
"
"2","Warning: number of items to replace is not a multiple of replacement length"
"0","reg.summary <- summary(fit)"
"0",""
"0",""
"0","data_frame(RMSE = sqrt(reg.summary$rss/nrow(Train)),"
"0","           Cp = reg.summary$cp, "
"0","           BIC = reg.summary$bic,"
"0","           AdjustedR2 = reg.summary$adjr2) %>%"
"0","    mutate(id = row_number()) %>%"
"0","    gather(Metric, value, -id) %>%"
"0","    ggplot(aes(id, value, col = Metric)) +"
"0","    geom_line() + "
"0","    geom_point() + "
"0","    labs(x = 'Number of Variables Used', y = '') + "
"0","    facet_wrap(~ Metric, scales = 'free') +"
"0","    scale_x_continuous(breaks = 1:17)"
